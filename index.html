<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrea Padoan - Personal trainer e nutrizionista a Verona</title>
    <meta name="description" content="Personal trainer e nutrizionista a Verona. Allenamenti personalizzati, pasti sani pronti e business coaching. Risultati garantiti in 90 giorni. Chiedimi tutto in chat!">
    <meta name="keywords" content="personal trainer verona, pasti sani verona, meal prep, business coaching, nutrizionista verona">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="./css/styles.css">
    
    <!-- Preload critical images -->
    <link rel="preload" as="image" href="./images/andrea-profile.jpg">
    <link rel="preload" as="image" href="./images/andrea-training-client.jpg">
    
    <!-- Page Loader Styles -->
    <style>
        /* Page Loader */
        #page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 99999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease-out;
        }
        
        .loader-container {
            text-align: center;
        }
        
        /* Loader Animation */
        .loader-circle {
            width: 80px;
            height: 80px;
            margin: 0 auto 30px;
            position: relative;
        }
        
        .loader-circle::before,
        .loader-circle::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            animation: loader-pulse 2s ease-in-out infinite;
        }
        
        .loader-circle::before {
            width: 100%;
            height: 100%;
            border: 3px solid #ff6b35;
            opacity: 0.3;
        }
        
        .loader-circle::after {
            width: 60%;
            height: 60%;
            top: 20%;
            left: 20%;
            background: linear-gradient(135deg, #ff6b35, #ff8c5a);
            animation-delay: 0.5s;
        }
        
        @keyframes loader-pulse {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.5;
            }
            100% {
                transform: scale(0.8);
                opacity: 1;
            }
        }
        
        .loader-text {
            color: #ff6b35;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            animation: loader-text-glow 1.5s ease-in-out infinite;
        }
        
        @keyframes loader-text-glow {
            0%, 100% {
                opacity: 0.5;
            }
            50% {
                opacity: 1;
                text-shadow: 0 0 20px rgba(255, 107, 53, 0.5);
            }
        }
        
        .loader-subtext {
            color: #b0b0b0;
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        /* Loading Progress Bar */
        .loader-progress {
            width: 200px;
            height: 2px;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 2px;
            margin: 20px auto 0;
            overflow: hidden;
        }
        
        .loader-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #ff8c5a);
            width: 0%;
            animation: loader-progress-fill 2s ease-out forwards;
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
        }
        
        @keyframes loader-progress-fill {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
        
        /* Hide loader when loaded */
        #page-loader.loaded {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Initial body state */
        body.loading {
            overflow: hidden;
        }
        
        /* Prevent FOUC (Flash of Unstyled Content) */
        .no-js #page-loader {
            display: none;
        }
    </style>
</head>
<body class="loading">
    <!-- Page Loader -->
    <div id="page-loader">
        <div class="loader-container">
            <div class="loader-circle"></div>
            <div class="loader-text">Andrea Padoan</div>
            <div class="loader-subtext">Preparazione del tuo percorso...</div>
            <div class="loader-progress">
                <div class="loader-progress-bar"></div>
            </div>
        </div>
    </div>
    
    <!-- Header -->
    <div id="header-container"></div>
    
    <!-- Hero Section -->
    <div id="hero-container"></div>
    
    <!-- Services Section (contiene gi√† i progetti) -->
    <div id="services-container"></div>
    
    <!-- Chat Section -->
    <div id="chat-section-container"></div>
    
    <!-- Chat Fullscreen (always present) -->
    <div id="chat-fullscreen-container"></div>
    
    <!-- Social Section -->
    <div id="social-container"></div>
    
    <!-- Contact Section -->
    <div id="contact-container"></div>

    <!-- Main JavaScript -->
    <script src="./js/main.js"></script>
    
    <!-- Parallax Effects Script -->
    <script src="./js/parallax-effects.js" defer></script>
    
    <!-- Load Components and Initialize -->
    <script>
        // ======================================
        // üöÄ PAGE LOADER MANAGER
        // ======================================
        
        class PageLoader {
            constructor() {
                this.loader = document.getElementById('page-loader');
                this.minimumLoadTime = 1500; // Tempo minimo di visualizzazione loader
                this.startTime = Date.now();
            }
            
            hide() {
                const elapsedTime = Date.now() - this.startTime;
                const remainingTime = Math.max(0, this.minimumLoadTime - elapsedTime);
                
                setTimeout(() => {
                    this.loader.classList.add('loaded');
                    document.body.classList.remove('loading');
                    
                    // Rimuovi loader dal DOM dopo l'animazione
                    setTimeout(() => {
                        this.loader.remove();
                    }, 500);
                    
                    // Trigger resize per ricalcolare layout
                    window.dispatchEvent(new Event('resize'));
                    
                    console.log('‚ú® Page fully loaded and ready!');
                }, remainingTime);
            }
        }
        
        const pageLoader = new PageLoader();
        
        // ======================================
        // üì¶ COMPONENT LOADER (ENHANCED)
        // ======================================
        
        const components = [
            { id: 'header-container', file: './components/header.html' },
            { id: 'hero-container', file: './components/hero.html' },
            { id: 'services-container', file: './components/services.html' },
            { id: 'chat-section-container', file: './components/chat-section.html' },
            { id: 'chat-fullscreen-container', file: './components/chat-fullscreen.html' },
            { id: 'social-container', file: './components/social.html' },
            { id: 'contact-container', file: './components/contact.html' }
        ];

        // Load component function with progress tracking
        async function loadComponent(containerId, filePath) {
            try {
                const response = await fetch(filePath);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const html = await response.text();
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = html;
                    console.log(`‚úÖ Loaded: ${filePath}`);
                } else {
                    console.warn(`‚ùå Container ${containerId} not found`);
                }
            } catch (error) {
                console.error(`‚ùå Error loading component ${filePath}:`, error);
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = `<div style="color: red; padding: 20px; text-align: center;">Errore nel caricamento della sezione. Ricarica la pagina.</div>`;
                }
            }
        }

        // Load all components with enhanced initialization
        async function loadAllComponents() {
            console.log('üîÑ Loading components...');
            
            const loadPromises = components.map(component => 
                loadComponent(component.id, component.file)
            );
            
            try {
                await Promise.all(loadPromises);
                console.log('‚úÖ All components loaded successfully');
                
                // Initialize main app
                if (typeof initializeApp === 'function') {
                    initializeApp();
                }
                
                // Initialize parallax effects (will auto-init when loaded)
                console.log('üåü Parallax effects will initialize automatically');
                
                // Hide loader after everything is ready
                pageLoader.hide();
                
            } catch (error) {
                console.error('‚ùå Error loading components:', error);
                // Hide loader even on error
                pageLoader.hide();
            }
        }

        // ======================================
        // üéØ PERFORMANCE OPTIMIZATIONS
        // ======================================
        
        // Preload critical resources
        function preloadResources() {
            const criticalImages = [
                './images/andrea-profile.jpg',
                './images/andrea-training-client.jpg',
                './images/andrea-tribu-studio.jpg'
            ];
            
            criticalImages.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }
        
        // Lazy load non-critical images
        function setupLazyLoading() {
            if ('IntersectionObserver' in window) {
                const images = document.querySelectorAll('img[data-src]');
                const imageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.classList.add('loaded');
                            imageObserver.unobserve(img);
                        }
                    });
                });
                
                images.forEach(img => imageObserver.observe(img));
            }
        }
        
        // ======================================
        // üöÄ INITIALIZATION
        // ======================================
        
        // Start loading when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üéØ DOM loaded, initializing Andrea Padoan Landing...');
            
            // Start preloading
            preloadResources();
            
            // Load all components
            loadAllComponents();
            
            // Setup lazy loading after a delay
            setTimeout(setupLazyLoading, 1000);
        });
        
        // Handle page visibility changes
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden) {
                // Refresh parallax when page becomes visible
                if (window.ParallaxEffects) {
                    window.ParallaxEffects.refresh();
                }
            }
        });
        
        // Error tracking
        window.addEventListener('error', (e) => {
            console.error('Global error:', e);
        });
        
        // Performance monitoring
        window.addEventListener('load', () => {
            if (performance && performance.timing) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                console.log(`üìä Page load time: ${loadTime}ms`);
            }
        });
    </script>
    
    <!-- No Script Fallback -->
    <noscript>
        <style>
            #page-loader { display: none !important; }
            body.loading { overflow: auto !important; }
        </style>
        <div style="background: #ff6b35; color: white; padding: 20px; text-align: center;">
            <p>Per una migliore esperienza, abilita JavaScript nel tuo browser.</p>
        </div>
    </noscript>
</body>
</html>