<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrea Padoan - Personal trainer e nutrizionista a Verona</title>
    <meta name="description" content="Personal trainer e nutrizionista a Verona. Allenamenti personalizzati, pasti sani pronti e business coaching. Risultati garantiti in 90 giorni. Chiedimi tutto in chat!">
    <meta name="keywords" content="personal trainer verona, pasti sani verona, meal prep, business coaching, nutrizionista verona">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="./css/styles.css">
    
    <!-- Preload critical images -->
    <link rel="preload" as="image" href="./images/andrea-profile.jpg">
    <link rel="preload" as="image" href="./images/andrea-training-client.jpg">
</head>
<body>
    
    <!-- Header -->
    <div id="header-container"></div>
    
    <!-- Hero Section -->
    <div id="hero-container"></div>
    
    <!-- Services Section (contiene gi√† i progetti) -->
    <div id="services-container"></div>
    
    <!-- Chat Section -->
    <div id="chat-section-container"></div>
    
    <!-- Chat Fullscreen (always present) -->
    <div id="chat-fullscreen-container"></div>
    
    <!-- Social Section -->
    <div id="social-container"></div>
    
    <!-- Contact Section -->
    <div id="contact-container"></div>

    <!-- Main JavaScript -->
    <script src="./js/main.js"></script>
    
    <!-- Parallax Effects Script -->
    <script src="./js/parallax-effects.js" defer></script>
    
    <!-- Load Components and Initialize -->
    <script>
        // ======================================
        // üì¶ COMPONENT LOADER
        // ======================================
        
        const components = [
            { id: 'header-container', file: './components/header.html' },
            { id: 'hero-container', file: './components/hero.html' },
            { id: 'services-container', file: './components/services.html' },
            { id: 'chat-section-container', file: './components/chat-section.html' },
            { id: 'chat-fullscreen-container', file: './components/chat-fullscreen.html' },
            { id: 'social-container', file: './components/social.html' },
            { id: 'contact-container', file: './components/contact.html' }
        ];

        // Load component function
        async function loadComponent(containerId, filePath) {
            try {
                const response = await fetch(filePath);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const html = await response.text();
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = html;
                    console.log(`‚úÖ Loaded: ${filePath}`);
                } else {
                    console.warn(`‚ùå Container ${containerId} not found`);
                }
            } catch (error) {
                console.error(`‚ùå Error loading component ${filePath}:`, error);
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = `<div style="color: red; padding: 20px; text-align: center;">Errore nel caricamento della sezione. Ricarica la pagina.</div>`;
                }
            }
        }

        // Load all components
        async function loadAllComponents() {
            console.log('üîÑ Loading components...');
            
            const loadPromises = components.map(component => 
                loadComponent(component.id, component.file)
            );
            
            try {
                await Promise.all(loadPromises);
                console.log('‚úÖ All components loaded successfully');
                
                // Initialize main app
                if (typeof initializeApp === 'function') {
                    initializeApp();
                }
                
                // Trigger resize per ricalcolare layout
                window.dispatchEvent(new Event('resize'));
                
                console.log('‚ú® Page fully loaded and ready!');
                
            } catch (error) {
                console.error('‚ùå Error loading components:', error);
            }
        }

        // ======================================
        // üéØ PERFORMANCE OPTIMIZATIONS
        // ======================================
        
        // Preload critical resources
        function preloadResources() {
            const criticalImages = [
                './images/andrea-profile.jpg',
                './images/andrea-training-client.jpg',
                './images/andrea-tribu-studio.jpg'
            ];
            
            criticalImages.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }
        
        // Lazy load non-critical images
        function setupLazyLoading() {
            if ('IntersectionObserver' in window) {
                const images = document.querySelectorAll('img[data-src]');
                const imageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.classList.add('loaded');
                            imageObserver.unobserve(img);
                        }
                    });
                });
                
                images.forEach(img => imageObserver.observe(img));
            }
        }
        
        // ======================================
        // üöÄ INITIALIZATION
        // ======================================
        
        // Start loading when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üéØ DOM loaded, initializing Andrea Padoan Landing...');
            
            // Start preloading
            preloadResources();
            
            // Load all components
            loadAllComponents();
            
            // Setup lazy loading after a delay
            setTimeout(setupLazyLoading, 1000);
        });
        
        // Handle scroll events for header
        let scrolled = false;
        window.addEventListener('scroll', () => {
            const header = document.querySelector('.header');
            if (header) {
                if (window.scrollY > 50 && !scrolled) {
                    header.classList.add('scrolled');
                    scrolled = true;
                } else if (window.scrollY <= 50 && scrolled) {
                    header.classList.remove('scrolled');
                    scrolled = false;
                }
            }
        });
        
        // Handle page visibility changes
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden) {
                // Refresh parallax when page becomes visible
                if (window.ParallaxEffects) {
                    window.ParallaxEffects.refresh();
                }
            }
        });
        
        // Error tracking
        window.addEventListener('error', (e) => {
            console.error('Global error:', e);
        });
        
        // Performance monitoring
        window.addEventListener('load', () => {
            if (performance && performance.timing) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                console.log(`üìä Page load time: ${loadTime}ms`);
            }
        });
    </script>
</body>
</html>